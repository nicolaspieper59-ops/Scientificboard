<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cockpit Cosmique</title>
  <link rel="manifest" href="manifest.json">
  <style>
    html, body {
      margin: 0;
      background: radial-gradient(ellipse at center, #000 0%, #111 100%);
      color: white;
      font-family: sans-serif;
      overflow: hidden;
    }
    canvas { position: absolute; top: 0; left: 0; z-index: 0; }
    #panel { position: fixed; top: 1em; right: 1em; background: rgba(0,0,0,0.7); padding: 1em; border-radius: 8px; z-index: 100; }
    button { margin: 0.2em; }
  </style>
</head>
<body>
<canvas id="sky"></canvas>
<div id="panel">
  <button onclick="toggleModule('vitesse')">Vitesse</button>
  <button onclick="toggleModule('respiration')">Respiration</button>
  <button onclick="toggleModule('plan√®tes')">Plan√®tes</button>
  <button onclick="toggleModule('journal')">Journal</button>
  <button onclick="toggleModule('artistique')">Artistique</button>
  <button onclick="toggleModule('m√©ditation')">M√©ditation</button>
</div>
<script>
let modules = { vitesse: true, respiration: false, plan√®tes: true, journal: true, artistique: false, m√©ditation: false };
function toggleModule(name) {
  modules[name] = !modules[name];
  document.getElementById(name + 'Module')?.classList.toggle('hidden', !modules[name]);
}

// Vitesse
let vitesseMax = 0, distanceTotale = 0, startTime = Date.now();
navigator.geolocation.watchPosition(pos => {
  const v = pos.coords.speed || 0;
  vitesseMax = Math.max(vitesseMax, v);
  distanceTotale += v * 1;
  document.getElementById('vitesseData').innerText =
    `Vitesse: ${v.toFixed(2)} m/s\nMax: ${vitesseMax.toFixed(2)}\nDistance: ${distanceTotale.toFixed(1)} m`;
}, null, { enableHighAccuracy: true });

// Respiration cosmique
setInterval(() => {
  if (!modules.respiration) return;
  const halo = document.getElementById('haloRespiration');
  halo.style.transform = `scale(${1 + 0.2 * Math.sin(Date.now()/1000)})`;
}, 100);
</script>
<div id="vitesseModule">
  <pre id="vitesseData"></pre>
</div>
<div id="respirationModule" class="hidden">
  <div id="haloRespiration" style="width:200px;height:200px;border-radius:50%;background:#0ff;opacity:0.3;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(1);transition:transform 1s;"></div>
</div>
<div id="plan√®tesModule">
  <canvas id="orbites" width="800" height="600" style="position:absolute;top:0;left:0;z-index:1;"></canvas>
</div>
<script>
const ctx = document.getElementById('orbites').getContext('2d');
function dessineOrbites() {
  ctx.clearRect(0, 0, 800, 600);
  const t = Date.now()/100000;
  const plan√®tes = [
    { nom: 'Mercure', r: 50, couleur: '#aaa' },
    { nom: 'V√©nus', r: 80, couleur: '#f5c' },
    { nom: 'Mars', r: 110, couleur: '#f33' },
    { nom: 'Jupiter', r: 150, couleur: '#fc3' },
    { nom: 'Saturne', r: 190, couleur: '#cc9' }
  ];
  plan√®tes.forEach(p => {
    const x = 400 + p.r * Math.cos(t/p.r);
    const y = 300 + p.r * Math.sin(t/p.r);
    ctx.beginPath();
    ctx.arc(x, y, 6, 0, 2*Math.PI);
    ctx.fillStyle = p.couleur;
    ctx.fill();
    ctx.fillText(p.nom, x+8, y);
  });
}
setInterval(() => { if (modules.plan√®tes) dessineOrbites(); }, 100);
</script>
<div id="journalModule" class="hidden">
  <button onclick="exportJournal()">üì§ Exporter Journal</button>
</div>
<script>
let journal = [];
function logGrandeur(nom, valeur) {
  journal.push({ nom, valeur, timestamp: Date.now() });
}
function exportJournal() {
  const blob = new Blob([JSON.stringify(journal, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'journal-cosmique.json';
  a.click();
}
setInterval(() => {
  if (!modules.journal) return;
  logGrandeur('vitesse', vitesseMax);
  logGrandeur('distance', distanceTotale);
}, 5000);
</script>
<div id="artistiqueModule" class="hidden">
  <canvas id="artCanvas" width="800" height="600" style="position:absolute;top:0;left:0;z-index:2;"></canvas>
</div>
<script>
const artCtx = document.getElementById('artCanvas').getContext('2d');
function dessineArt() {
  if (!modules.artistique) return;
  const lumi√®re = Math.random()*1000;
  const pression = 1000 + Math.random()*50;
  const uv = Math.random()*10;
  artCtx.fillStyle = `rgba(${uv*25},${pression%255},${lumi√®re%255},0.2)`;
  artCtx.beginPath();
  artCtx.arc(Math.random()*800, Math.random()*600, uv*5, 0, 2*Math.PI);
  artCtx.fill();
}
setInterval(dessineArt, 300);
</script>
<div id="m√©ditationModule" class="hidden">
  <button onclick="startMeditation()">üßò‚Äç‚ôÇÔ∏è D√©marrer</button>
</div>
<script>
let audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function startMeditation() {
  const left = audioCtx.createOscillator();
  const right = audioCtx.createOscillator();
  const splitter = audioCtx.createChannelMerger(2);
  left.frequency.value = 440;
  right.frequency.value = 447.83; // 7.83 Hz binaural beat
  left.connect(splitter, 0, 0);
  right.connect(splitter, 0, 1);
  splitter.connect(audioCtx.destination);
  left.start();
  right.start();
}
</script>
<script>
// Capteurs physiques
if ('AmbientLightSensor' in window) {
  const light = new AmbientLightSensor();
  light.onreading = () => {
    document.body.style.background = `radial-gradient(circle, rgba(255,255,255,${light.illuminance/10000}) 0%, #000 100%)`;
    logGrandeur('lumi√®re', light.illuminance);
  };
  light.start();
}
if ('Magnetometer' in window) {
  const mag = new Magnetometer();
  mag.onreading = () => {
    const champ = Math.sqrt(mag.x**2 + mag.y**2 + mag.z**2);
    logGrandeur('champ magn√©tique', champ);
  };
  mag.start();
}
if ('DeviceOrientationEvent' in window) {
  window.addEventListener('deviceorientation', e => {
    const azimut = e.alpha?.toFixed(1);
    const inclinaison = e.beta?.toFixed(1);
    logGrandeur('orientation', `${azimut}¬∞ / ${inclinaison}¬∞`);
  });
}

// Heure solaire locale
function heureSolaire() {
  const now = new Date();
  const offset = (2 * Math.PI * (now.getHours()*3600 + now.getMinutes()*60 + now.getSeconds()) / 86400);
  return offset.toFixed(2) + ' rad';
}

// Phase lunaire simplifi√©e
function phaseLunaire() {
  const now = new Date();
  const synodique = 29.53058867;
  const ref = new Date('2025-09-14'); // derni√®re nouvelle lune
  const diff = (now - ref) / (1000 * 60 * 60 * 24);
  const phase = (diff % synodique) / synodique;
  return (phase*100).toFixed(1) + '%';
}

// Mar√©es (simplifi√©es)
function hauteurMar√©e() {
  const phase = parseFloat(phaseLunaire());
  return (2 * Math.sin(phase * Math.PI / 50)).toFixed(2) + ' m';
}

// Vitesse lumi√®re/son
function pourcentagesVitesse(v) {
  const son = (v / 343 * 100).toFixed(2);
  const lumi√®re = (v / 299792458 * 100).toExponential(2);
  return `üå¨Ô∏è ${son}% du son ‚Äî üí° ${lumi√®re}% de la lumi√®re`;
}
</script>
</body>
</html>
